<h1 style="padding-top: 70px;"><%= link_to "⇚", posts_path %> </h1>

<div class="card-list-container">
  <div class="card mx-auto mt-4 shadow-lg" style="width: 100%;">
    <div class="card-body">
      <div class="card-title">
        <div class="row">
          <div class="col-9">
            <%= image_tag @user.get_user_image(200,200), class: "mt-3 rounded-circle img-thumbnail"; %><br><strong><%= @user.user_name %></strong>
          </div>
          <div class="col-3 text-right pt-4">
            <br>
            <% if current_user.user_name == "guestuser" %>
            <% elsif current_user == @user %>
              <%= link_to edit_users_information_path, class: "btn btn-outline-secondary btn-block" do %><i class="fa-solid fa-user-pen"></i><% end %>
            <% else %>
              <% if current_user.following?(@user) %>
                <%= link_to "フォロー中", user_followings_path(@user.id), method: :delete, class: 'btn btn-secondary' %>
              <% else %>
                <%= link_to "フォローする", user_followings_path(@user.id), method: :post, class: 'btn btn-success' %>
              <% end %>
            <% end %>
          </div>
        </div>
        <div class="row pt-5">
          <div class="card-text pl-3">
            <h4><%= @user.profile %></h4>
          </div>
        </div>
        <div class="row pt-5">
          <div class="col-3">
            フォロー
            <%= link_to user_follow_index_path(@user.id) do %>
              <%= @user.relationships.count %>
            <% end %>
            フォロワー
            <%= link_to user_followers_path(@user.id) do %>
              <%= @user.followers.count %>
            <% end %>
            <%= link_to user_likes_index_path(@user.id), class: "btn btn-outline-info btn-block mt-3" do %>
              <i class="fa-solid fa-hand-holding-heart"></i>
            <% end %>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>



<h2 class="text-center mt-5">POST一覧</h2>
<div class="card-list-container py-5">
  <% @posts.each do |posts| %>
    <div class="card mx-auto mt-4 shadow-lg" style="width: 70%;">
      <div class="card-body">
        <div class="card-title">
          <div class="row">
            <div class="col-10">
              <%= link_to users_my_page_path(posts.user.id) do %>
                <%= image_tag posts.user.get_user_image(100,100), class: "mt-3 rounded-circle img-thumbnail"; %>
                <strong><%= posts.user.user_name %></strong>
              <% end %>
            </div>
            <div class="text-right pt-4">
              <% if posts.user == current_user %>
                <%= link_to "削除", post_path(posts.id), method: :delete, class:"btn btn-sm btn-danger", data: {confirm: "本当に消しますか？"} %>
              <% elsif current_user.following?(posts.user) %>
                <%= link_to "フォロー中", user_followings_path(posts.user.id), method: :delete, class: 'btn btn-secondary' %>
              <% else %>
                <%= link_to "フォロー", user_followings_path(posts.user.id), method: :post, class: 'btn btn-success' %>
              <% end %>
            </div>
          </div>
          <%= link_to post_path(posts.id) do %>
            <div class="row py-5">
              <div class="card-text pl-3">
                <%= posts.post_text %>
              </div>
            </div>
            <div class="row">
              <% if posts.image.attached? %>
                <%= image_tag posts.image, class: "card-img-top img-thumbnail"; %>
              <%else%>
              <%end%>
            </div>
          <% end %>
          <div class="row mt-4" style="display: flex; justify-content: center; align-items: center;">
            <% if posts.liked_by?(current_user) %>
              <%= link_to post_likes_path(posts), method: :delete do %>
                <i class="fa-solid fa-heart"></i><%= posts.likes.count %>
              <% end %>
            <% else %>
              <%= link_to post_likes_path(posts), method: :post do %>
                <i class="fa-regular fa-heart"></i><%= posts.likes.count %>
              <% end %>
            <% end %>
            <%= link_to post_path(posts.id), class: "ml-4" do %>
              <i class="fa-regular fa-comment"></i><%= posts.comments.count %>
            <% end %>
          </div>
        </div>
      </div>
    </div>
  <% end %>
</div>







