<h1><%= link_to "⇚", posts_path %> </h1>
<div class="card-list-container py-5">
  <div class="card w-51 mx-auto mt-4 shadow-lg">
    <div class="card-body">
      <div class="card-title">
        <div class="row">
          <div class="col-10">
            <%= link_to users_my_page_path(@post.user.id) do %>
              <%= image_tag @post.user.get_user_image(100,100), class: "mt-3 rounded-circle img-thumbnail"; %>
              <span><strong><%= @post.user.user_name %></strong></span>
            <% end %>
          </div>
          <div class="text-right pt-4">
            <% if @post.user == current_user %>
              <%= link_to "削除", post_path(@post.id), method: :delete, class:"btn btn-sm btn-danger", data: {confirm: "本当に消しますか？"} %>
            <% elsif current_user.following?(@user) %>
              <%= link_to "フォロー中", user_followings_path(@user.id), method: :delete, class: 'btn btn-secondary' %>
            <% else %>
              <%= link_to "フォローする", user_followings_path(@user.id), method: :post, class: 'btn btn-success' %>
            <% end %>
          </div>
        </div>
        <div class="row py-5">
          <div class="card-text pl-3">
            <h4><%= @post.post_text %></h4>
          </div>
        </div>
        <div class="row">
          <% if @post.image.attached? %>
            <%= image_tag @post.image, class: "card-img-top img-thumbnail"; %>
          <% else %>
          <% end %>
        </div>
        <div class="row">
          <% if @post.liked_by?(current_user) %>
            <p>
              <%= link_to post_likes_path(@post), method: :delete do %>
                ♥<%= @post.likes.count %> いいね
              <% end %>
            </p>
          <% else %>
            <p>
              <%= link_to post_likes_path(@post), method: :post do %>
                ♡<%= @post.likes.count %> いいね
              <% end %>
            </p>
          <% end %>
        </div>
        <div class="row py-5">
          <%= form_with model: [@post, @comment] do |f| %>
            <%= f.text_area :comment_text, rows: '5', placeholder: "コメントをここに" %>
            <%= f.submit "送信する" %>
          <% end %>
          <p>コメント件数：<%= @post.comments.count %></p>
          <% @post.comments.each do |comment| %>
            <p><%= image_tag comment.user.get_user_image(100,100) %></p>
            <%= comment.user.user_name %>
            <%= comment.created_at.strftime('%Y/%m/%d') %><%= comment.comment_text %>
            <% if comment.user == current_user %>
              <%= link_to "削除", post_comment_path(comment.post, comment), method: :delete %>
            <% end %>
          <% end %>
        </div>
      </div>
    </div>
  </div>
</div>
